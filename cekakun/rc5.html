<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Hive RC & Estimator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  font-family:system-ui,Arial;
  background:#0f172a;
  color:#e5e7eb;
  padding:20px
}
input,button{
  padding:10px;
  font-size:16px
}
.card{
  background:#111827;
  border-radius:12px;
  padding:16px;
  margin-top:16px
}
.grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:12px
}
.item{
  background:#1f2933;
  padding:10px;
  border-radius:8px
}
.label{
  font-size:12px;
  opacity:.7
}
.value{
  font-size:16px;
  font-weight:bold
}
.bar{
  background:#020617;
  border-radius:10px;
  overflow:hidden;
  height:16px;
  margin-top:6px
}
.fill{
  height:100%;
  background:linear-gradient(90deg,#22c55e,#4ade80)
}
small{opacity:.7}
</style>
</head>
<body>

<h1>Hive Account RC Estimator</h1>

<input id="user" placeholder="username hive">
<button onclick="cek()">Cek</button>

<div id="ui"></div>

<script>
let rcInterval=null;

function parseAmount(v){
  return parseFloat(v.split(" ")[0]);
}

function estimasiAktivitas(rcPercent){
  return {
    komentar_pendek: Math.floor(rcPercent / 1.5),
    post_sedang: Math.floor(rcPercent / 6),
    post_besar: Math.floor(rcPercent / 15),
    upvote: Math.floor(rcPercent / 0.3),
    transfer: Math.floor(rcPercent / 0.8)
  };
}

async function cek(){
  if(rcInterval) clearInterval(rcInterval);

  const u=document.getElementById("user").value.trim().toLowerCase();

  const [accRes, globalRes] = await Promise.all([
    fetch("https://api.hive.blog",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({
        jsonrpc:"2.0",
        method:"condenser_api.get_accounts",
        params:[[u]],
        id:1
      })
    }),
    fetch("https://api.hive.blog",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({
        jsonrpc:"2.0",
        method:"condenser_api.get_dynamic_global_properties",
        params:[],
        id:2
      })
    })
  ]);

  const data=(await accRes.json()).result[0];
  const global=(await globalRes.json()).result;

  if(!data){
    document.getElementById("ui").innerHTML="Akun tidak ditemukan";
    return;
  }

  const vests=parseAmount(data.vesting_shares);
  const totalFund=parseAmount(global.total_vesting_fund_hive);
  const totalVests=parseAmount(global.total_vesting_shares);

  const hp=(vests * totalFund / totalVests).toFixed(3);

  const maxMana=vests*1e6;
  const baseMana=data.voting_manabar.current_mana;
  const last=data.voting_manabar.last_update_time;
  const regenSeconds=432000;

  function render(){
    const now=Math.floor(Date.now()/1000);
    const elapsed=now-last;
    const regen=(maxMana/regenSeconds)*elapsed;
    const current=Math.min(maxMana,baseMana+regen);
    const rcPercent=(current/maxMana)*100;
    const rcAbsolute=Math.floor(current);
    const est=estimasiAktivitas(rcPercent);

    document.getElementById("ui").innerHTML=`
      <div class="card">
        <h2>@${data.name}</h2>
        <small>Dibuat: ${new Date(data.created).toLocaleString()}</small>
      </div>

      <div class="card">
        <div class="label">Resource Credits (Realtime)</div>
        <div class="bar">
          <div class="fill" style="width:${rcPercent.toFixed(2)}%"></div>
        </div>
        <small>${rcPercent.toFixed(2)}% • ${rcAbsolute.toLocaleString()} RC</small>
      </div>

      <div class="card grid">
        <div class="item"><div class="label">Komentar / Post pendek</div><div class="value">≈ ${est.komentar_pendek}x</div></div>
        <div class="item"><div class="label">Post sedang</div><div class="value">≈ ${est.post_sedang}x</div></div>
        <div class="item"><div class="label">Post besar</div><div class="value">≈ ${est.post_besar}x</div></div>
        <div class="item"><div class="label">Upvote</div><div class="value">≈ ${est.upvote}x</div></div>
        <div class="item"><div class="label">Transfer</div><div class="value">≈ ${est.transfer}x</div></div>
      </div>

      <div class="card grid">
        <div class="item"><div class="label">Hive Power (HP)</div><div class="value">${hp} HP</div></div>
        <div class="item"><div class="label">VESTS</div><div class="value">${data.vesting_shares}</div></div>
        <div class="item"><div class="label">HIVE</div><div class="value">${data.balance}</div></div>
        <div class="item"><div class="label">HBD</div><div class="value">${data.hbd_balance}</div></div>
      </div>
    `;
  }

  render();
  rcInterval=setInterval(render,1000);
}
</script>

</body>
</html>